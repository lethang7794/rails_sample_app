var old_vote_value = $("#micropost-<%= @micropost.id %>-vote-value").html();

$("#micropost-<%= @micropost.id %>-vote-container").html("<%= escape_javascript(
  render partial: 'shared/micropost/info_bar/upvote_form', locals: { micropost: @micropost }
) %>");


// Disable all stat container buttons
$( ".stat-container form > button" ).attr("disabled", true);

var $vote_value = $("#micropost-<%= @micropost.id %>-vote-value");

var $vote_value_wrapper = $("#micropost-<%= @micropost.id %>-vote-value-wrapper");
var $vote_button_wrapper = $("#micropost-<%= @micropost.id %>-vote-button-wrapper");
var $vote_button_svg_path_auxiliary = $vote_button_wrapper.find(".auxiliary");

var $vote_value_clone = $vote_value.clone().addClass("pos-abs");
$vote_value_clone.html(old_vote_value).css("visibility", "visible");
$vote_value_clone.prependTo($vote_value_wrapper);

$vote_value.removeClass("tran-03s").addClass("move-up tran-0s");

$vote_button_svg_path_auxiliary.removeClass("fill-transparent");

setTimeout(function () {
  $vote_value_clone.addClass( "move-down" );
  $vote_value.removeClass("move-up tran-0s").addClass("tran-03s");
  $vote_button_svg_path_auxiliary.addClass("fill-transparent");
}, 1); // Use delay to not override transform, and cause no transition

$vote_value_clone.on('animationcancel', function(){
  $(this).remove();
});

setTimeout(function () {
  $vote_value_clone.remove();
  $( ".stat-container form > button" ).attr("disabled", false); // Re-enable all stat container buttons
}, 301);
